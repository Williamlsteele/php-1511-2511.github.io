library(survival)
model <- survfit(Surv(cayrs,crc) ~csmok,
data = phscrc)
model
library(survminer)
ggsurvplot(model, conf.int=FALSE, risk.table=TRUE,
risk.table.col="strata", legend.labs =
c("Non-Drinker", "Drinker", "t"), break.time.by=2)
library(survival)
model <- survfit(Surv(cayrs,crc) ~alcohol.use,
data = phscrc)
model
library(survminer)
ggsurvplot(model, conf.int=FALSE, risk.table=TRUE,
risk.table.col="strata", legend.labs =
c("Non-Drinker", "Drinker", "t"), break.time.by=2)
library(survminer)
ggsurvplot(model, conf.int=FALSE, risk.table=TRUE,
risk.table.col="strata", legend.labs =
c("Non-Drinker", "Drinker"), break.time.by=2)
library(survminer)
ggsurvplot(model, conf.int=FALSE, risk.table=TRUE,
risk.table.col="strata", legend.labs =
c("Non-Drinker", "Drinker"), break.time.by=2, ylim=c(0.75,1))
library(survminer)
ggsurvplot(model, conf.int=FALSE, risk.table=TRUE,
risk.table.col="strata", legend.labs =
c("Non-Drinker", "Drinker"), break.time.by=2, ylim=c(0.95,1))
model <- survdiff(Surv(cayrs,crc) ~ alcohol.use,
data = phscrc)
model
summary(phscrc$cayrs)
sum(phscrc$cayrs==0)
sum(phscrc$cayrs==0, na.rm=T)
sum(phscrc$cayrs>0, na.rm=T)
library(survival)
model <- survfit(Surv(cayrs,crc) ~ alcohol.use,
data = subset(phscrc, cayrs>0))
model
model <- survdiff(Surv(cayrs,crc) ~ alcohol.use,
data = subset(phscrc, cayrs>0))
model
model <- survdiff(Surv(cayrs,crc) ~ alcohol.use,
data = subset(phscrc, cayrs>0))
model
model <- survfit(Surv(cayrs,crc) ~csmok,
data = subset(phscrc, cayrs>0))
model
library(survminer)
ggsurvplot(model, conf.int=TRUE, risk.table=TRUE,
risk.table.col="strata", break.time.by=2)
library(survminer)
ggsurvplot(model, conf.int=TRUE, risk.table=TRUE,
risk.table.col="strata", break.time.by=2, ylim=c(0.95,1))
library(car)
vif(model)
library(knitr)
opts_chunk$set(error = TRUE)
opts_chunk$set(warning=FALSE)
opts_chunk$set(message=FALSE)
opts_chunk$set(results="hold")
opts_chunk$set(cache=T)
opts_chunk$set(  tidy=TRUE,size="small")
opts_chunk$set(tidy.opts=list(width.cutoff=60))
options(digits = 3, scipen = 3)
library(survminer)
ggsurvplot(model, legend.labs =
c("Non-Drinker", "Drinker"),
break.time.by=.5, fun="cloglog")
library(survival)
model <- survfit(Surv(cayrs,crc) ~ alcohol.use,
data = subset(phscrc, cayrs>0))
model
library(survminer)
ggsurvplot(model, legend.labs =
c("Non-Drinker", "Drinker"),
break.time.by=.5, fun="cloglog")
library(survminer)
ggsurvplot(model, legend.labs =
c("Non-Drinker", "Drinker"),
break.time.by=2, fun="cloglog")
library(survminer)
ggsurvplot(model, legend.labs =
c("Non-Drinker", "Drinker"),
break.time.by=2, fun="cloglog")
cox.crc <- coxph(Surv(cayrs,crc) ~ alcohol.use,
data = subset(phscrc, cayrs>0))
summary(cox.crc)
library(survival)
crc.cox <- coxph(Surv(cayrs, crc) ~ csmok + age , data= subset(phscrc, cayrs>0))
summary(crc.cox)
library(knitr)
opts_chunk$set(error = TRUE)
opts_chunk$set(warning=FALSE)
opts_chunk$set(message=FALSE)
opts_chunk$set(results="hold")
opts_chunk$set(cache=T)
opts_chunk$set(  tidy=TRUE,size="small")
opts_chunk$set(tidy.opts=list(width.cutoff=60))
options(digits = 3, scipen = 3)
model <- survfit(Surv(cayrs,crc) ~csmok,
data = subset(phscrc, cayrs>0))
model
ggsurvplot(model, conf.int=TRUE, risk.table=TRUE,
risk.table.col="strata", break.time.by=2, ylim=c(0.95,1))
load("C:/Users/adam_/Dropbox (Personal)/Brown/Teaching/Brown Courses/PHP2511/Spring2017/Labs/brfss.rda")
load("C:/Users/adam_/Dropbox (Personal)/Brown/Teaching/Brown Courses/PHP2511/Spring2017/Labs/brfss.rda")
library(knitr)
opts_chunk$set(error = TRUE)
opts_chunk$set(warning=FALSE)
opts_chunk$set(message=FALSE)
opts_chunk$set(results="hold")
opts_chunk$set(cache=F)
opts_chunk$set(  tidy=TRUE,size="small")
opts_chunk$set(tidy.opts=list(width.cutoff=60))
options(digits = 3, scipen = 3)
phscrc$mean.cent.age <- phscrc$age - mean(phscrc$age, na.rm=TRUE)
fit5 <- glm(crc~alcohol.use + mean.cent.age + offset(log(cayrs)), data=phscrc, family=poisson(link='log'))
library(knitr)
opts_chunk$set(error = TRUE)
opts_chunk$set(warning=FALSE)
opts_chunk$set(message=FALSE)
opts_chunk$set(results="hold")
opts_chunk$set(cache=F)
opts_chunk$set(  tidy=TRUE,size="small")
opts_chunk$set(tidy.opts=list(width.cutoff=60))
options(digits = 3, scipen = 3)
library(tidyverse)
library(haven)
phscrc <- read_dta("phscrc.dta")
phscrc <- phscrc %>%
mutate(age.cat = cut(age, c(40,50,60,70, 90), right=FALSE)) %>%
mutate(alcohol.use = factor(phscrc$alcohol>0, labels=c("no", "yes")))
phscrc$mean.cent.age <- phscrc$age - mean(phscrc$age, na.rm=TRUE)
fit5 <- glm(crc~alcohol.use + mean.cent.age + offset(log(cayrs)), data=phscrc, family=poisson(link='log'))
summary(fit5, dispersion=.7)
summary(fit5, dispersion=1.7)
library(knitr)
opts_chunk$set(error = TRUE)
opts_chunk$set(warning=FALSE)
opts_chunk$set(message=FALSE)
opts_chunk$set(results="hold")
opts_chunk$set(cache=T)
opts_chunk$set(  tidy=F,size="small")
opts_chunk$set(tidy.opts=list(width.cutoff=60))
options(digits = 3, scipen = 3)
after.life <- read.table("after_life.csv", header=TRUE, sep=",")
after.life$race <- factor(after.life$race, levels = c(0,1), labels=c("Black", "White"))
after.life$sex <- factor(after.life$sex, levels = c(0,1), labels=c("Male", "Female"))
after.life$belief <- factor(after.life$belief, levels = c(2,1,3),
labels=c("Undecided","Yes",  "No"))
library(knitr)
opts_chunk$set(error = TRUE)
opts_chunk$set(warning=FALSE)
opts_chunk$set(message=FALSE)
opts_chunk$set(results="hold")
opts_chunk$set(cache=T)
opts_chunk$set(  tidy=F,size="small")
opts_chunk$set(tidy.opts=list(width.cutoff=60))
options(digits = 3, scipen = 3)
mod <-fit1
better.table <- cbind("Estimate" = round(coef(mod), 3),
"Odds Ratio"= round(exp(coef(mod)), 3),
"95% CI of OR"=  paste("(", round(exp(summary(mod)@coef3[,1] - 1.96* summary(mod)@coef3[,2]), 3), ",", round(exp(summary(mod)@coef3[,1] + 1.96* summary(mod)@coef3[,2]),3) , ")"),
"p-Value " = round(summary(mod)@coef3[,4], 4)     )
knitr::kable(better.table, format='markdown')
library(VGAM)
fit1 <- vglm(belief ~ race + sex, data=after.life, weights=count, family=multinomial)
mod <-fit1
better.table <- cbind("Estimate" = round(coef(mod), 3),
"Odds Ratio"= round(exp(coef(mod)), 3),
"95% CI of OR"=  paste("(", round(exp(summary(mod)@coef3[,1] - 1.96* summary(mod)@coef3[,2]), 3), ",", round(exp(summary(mod)@coef3[,1] + 1.96* summary(mod)@coef3[,2]),3) , ")"),
"p-Value " = round(summary(mod)@coef3[,4], 4)     )
knitr::kable(better.table, format='markdown')
library(haven)
sah <- read_dta("sah.dta")
str(sah$sah)
#Reverse order for self assessed health
sah$sah <- factor(sah$sah, levels=rev(levels(sah$sah)))
str(sah$sah)
library(haven)
sah <- read_dta("sah.dta")
str(sah$sah)
#Reverse order for self assessed health
sah$sah <- as.factor(sah$sah, levels=rev(levels(sah$sah)))
str(sah$sah)
as.factor(sah$sah)
str(sah$sah)
rev(levels(sah$sah)
)
levels(sah$sah)
sah <- read_dta("sah.dta")
levels(sah$sah)
rev(levels(sah$sah)
)
str(sah$sah)
sah$sah$names
attr(sah$sah)
attributes(sah$sah)
sah$sah <- as.factor(sah$sah, levels=attributes(sah$sah)$labels)
?as.factor
sah$sah <- factor(sah$sah, levels=attributes(sah$sah)$labels)
table(sah$sah)
sah <- read_dta("sah.dta")
#Reverse order for self assessed health
sah$sah2 <- factor(sah$sah)
library(haven)
sah <- read_dta("sah.dta")
str(sah$sah)
#Reverse order for self assessed health
sah$sah2 <- factor(sah$sah)
levels(sah$sah2) <- attributes(sah$sah)$names
str(sah$sah)
attributes(sah$sah)$names
str(sah$sah)
attributes(sah$sah)$lables$names
attributes(sah$sah)$labels$names
attributes(sah$sah)
attributes(sah$sah)$labels
levels(sah$sah2) <- attributes(sah$sah)$lables
levels(sah$sah2) <- attributes(sah$sah)$labels
table(sah$sah2)
lables(sah$sah2) <- attributes(sah$sah)$labels
labels(sah$sah2) <- attributes(sah$sah)$labels
attributes(sah$sah)$labels
names(attributes(sah$sah)$labels)
#Reverse order for self assessed health
sah$sah2 <- factor(sah$sah, labels = names(attributes(sah$sah)$labels))
table(sah$sah2)
sah$sah <- factor(sah$sah2, levels = rev(levels(sah$sah2)))
table(sah$sah)
library(VGAM)
fit2 <- vglm(as.ordered(sah) ~ pperf + perf + cogerr + mile + loop + age, data=sah,  family=acat(reverse=TRUE))
mod <-fit2
better.table <- cbind("Estimate" = round(coef(mod), 3),
"Odds Ratio"= round(exp(coef(mod)), 3),
"95% CI of OR"=  paste("(", round(exp(summary(mod)@coef3[,1] - 1.96* summary(mod)@coef3[,2]), 3), ",", round(exp(summary(mod)@coef3[,1] + 1.96* summary(mod)@coef3[,2]),3) , ")"),
"p-Value " = round(summary(mod)@coef3[,4], 4)     )
knitr::kable(better.table[1:6,])
knitr::kable(better.table[7:15,])
knitr::kable(better.table[15:21,])
library(VGAM)
fit3 <- vglm(as.ordered(sah) ~ pperf + perf + cogerr + mile + loop + age, data=sah,  family=cumulative)
mod <-fit3
better.table <- cbind("Estimate" = round(coef(mod), 3),
"Odds Ratio"= round(exp(coef(mod)), 3),
"95% CI of OR"=  paste("(", round(exp(summary(mod)@coef3[,1] - 1.96* summary(mod)@coef3[,2]), 3), ",", round(exp(summary(mod)@coef3[,1] + 1.96* summary(mod)@coef3[,2]),3) , ")"),
"p-Value " = round(summary(mod)@coef3[,4], 4)     )
knitr::kable(better.table[1:6,])
fit.pbc1 <- lm(plat.cnt ~ dis.stage, data=pbc)
pbc <- read.table("pbc.csv", header=TRUE, sep=",")
colnames(pbc) <- c("casenum", "n.days", "death", "treated", "age" , "sex",
"ascites", "hepatomegaly", "spiders", "edema",
"bilirubin", "choles", "albumin", "ur.cop",
"alk.phos", "sgot", "trigly",
"plat.cnt", "pt", "dis.stage")
names(summ)
library(leaps)
leaps <- regsubsets(sysbp1t~ bmi1 + age1 +
diabp1 + prevhyp1 + prevchd1 + prevmi1 +
cursmoke1 + cigpday1 + bpmeds1, data=fhs, nbest=1)
library(knitr)
opts_chunk$set(error = TRUE)
opts_chunk$set(warning=FALSE)
opts_chunk$set(message=FALSE)
opts_chunk$set(results="hold")
opts_chunk$set(cache=T)
opts_chunk$set(  tidy=F,size="small")
opts_chunk$set(tidy.opts=list(width.cutoff=60))
options(digits = 3, scipen = 3)
library(knitr)
library(broom)
knitr::opts_chunk$set(
tidy=FALSE,     # display code as typed
size="small",
eval=TRUE,
warning = FALSE,
message=FALSE)
library(foreign)
fhs <- read.dta("https://drive.google.com/uc?export=download&id=0B8CsRLdwqzbzWFc2R0ozTlAzcjQ")
library(car)
p<-powerTransform(fhs$sysbp1)
fhs$sysbp1t <-bcPower(fhs$sysbp1,p$lambda)
library(leaps)
leaps <- regsubsets(sysbp1t~ bmi1 + age1 +
diabp1 + prevhyp1 + prevchd1 + prevmi1 +
cursmoke1 + cigpday1 + bpmeds1, data=fhs, nbest=1)
library(dplyr)
summ <- summary(leaps)
kable(as_data_frame(summ$which)[,-1], format="markdown")
library(car)
layout(matrix(1:2, ncol = 2))
# Adjusted R2
res.legend <- subsets(leaps, statistic="adjr2", legend = FALSE, min.size = 3,
main = "Adjusted R^2")
# Mallow Cp
res.legend <- subsets(leaps, statistic="cp", legend = FALSE, min.size = 3,
main = "Mallow Cp")
abline(a = 1, b = 1, lty = 2)
res.legend
plot(leaps, scale="adjr2", main="")
#Variables we care about in model
myvars <- c("sysbp1t", "bmi1", "age1", "diabp1", "prevhyp1", "prevchd1",
"prevmi1", "cursmoke1", "cigpday1", "bpmeds1")
#Selecting only these variables
fhs_sub_sel <- fhs[myvars]
#Selecting only those rows with complete cases
fhs_sub_sel <- fhs_sub_sel[complete.cases(fhs_sub_sel),]
pbc <- read.table("pbc.csv", header=TRUE, sep=",")
colnames(pbc) <- c("casenum", "n.days", "death", "treated", "age" , "sex",
"ascites", "hepatomegaly", "spiders", "edema",
"bilirubin", "choles", "albumin", "ur.cop",
"alk.phos", "sgot", "trigly",
"plat.cnt", "pt", "dis.stage")
fit.pbc1 <- lm(plat.cnt ~ dis.stage, data=pbc)
kable(tidy(fit.pbc1, conf.int=T)[, -c(3,4)])
fit.pbc2 <- lm(plat.cnt ~ as.factor(dis.stage), data=pbc)
kable(tidy(fit.pbc2, conf.int=T)[, -c(3,4)])
anova(fit.pbc1, fit.pbc2)
install.packages("survey")
library(knitr)
opts_chunk$set(error = TRUE)
opts_chunk$set(warning=FALSE)
opts_chunk$set(message=FALSE)
opts_chunk$set(results="hold")
opts_chunk$set(cache=F)
opts_chunk$set(  tidy=F,size="small")
opts_chunk$set(tidy.opts=list(width.cutoff=60))
options(digits = 3, scipen = 3)
#Sometimes strata only have one person in them
# We need to tell R how to adjust for this
options(survey.lonely.psu = "adjust")
svytotal(~insurance, brfss.design)
svytotal(~imprace, brfss.design)
#We could also have this done for more than one
#variable at a time:
svytotal(~insurance + imprace, brfss.design)
library(survey)
?svytotal
library(survey)
#Sometimes strata only have one person in them
# We need to tell R how to adjust for this
options(survey.lonely.psu = "adjust")
svytotal(~insurance, brfss.design)
svytotal(~imprace, brfss.design)
#We could also have this done for more than one
#variable at a time:
svytotal(~insurance + imprace, brfss.design)
View(mod)
library(VGAM)
cfibrosis
exp(-2.6)
library(olsrr)
?ols_rvsp_plot
?ols_score_test
?ols_f_test
library(knitr)
options(digits=3)
knitr::opts_chunk$set(error = TRUE)
knitr::opts_chunk$set(warning=FALSE)
knitr::opts_chunk$set(message=FALSE)
knitr::opts_chunk$set(results="hold")
knitr::opts_chunk$set(cache=TRUE)
knitr::opts_chunk$set(echo=FALSE)
cigs <- read.table("http://www.amstat.org/publications/jse/datasets/cigarettes.dat.txt")
names(cigs) <- c("brand", "tar", "nicotine", "weight", "CO" )
library(tidyverse)
library(broom)
library(knitr)
fit1 <- lm(CO ~tar, data=cigs)
fit2 <- lm(CO ~nicotine, data=cigs)
fit3 <- lm(CO ~weight, data=cigs)
tidy1 <- tidy(fit1, conf.int=T)[-1,-c(3:4)]
tidy2 <- tidy(fit2, conf.int=T)[-1,-c(3:4)]
tidy3 <- tidy(fit3, conf.int=T)[-1,-c(3:4)]
kable(bind_rows(tidy1,tidy2,tidy3), format = "latex")
bind_rows(tidy1,tidy2,tidy3)
glance1 <- glance(fit1)
glance2 <- glance(fit2)
glance3 <- glance(fit3)
tab <- bind_rows(glance1,glance2,glance3)[,c(1:5)]
rownames(tab) <- c("tar", "nicotine", "weight")
kable(tab, format = "latex")
tab
library(knitr)
opts_chunk$set(error = TRUE)
opts_chunk$set(warning=FALSE)
opts_chunk$set(message=FALSE)
opts_chunk$set(results="hold")
opts_chunk$set(cache=F)
opts_chunk$set(  tidy=F,size="small")
opts_chunk$set(tidy.opts=list(width.cutoff=60))
options(digits = 3, scipen = 3)
library(foreign)
fhs <- read.dta("https://drive.google.com/uc?export=download&id=0B8CsRLdwqzbzWFc2R0ozTlAzcjQ")
library(car)
p<-powerTransform(fhs$sysbp1)
fhs$sysbp1t <-bcPower(fhs$sysbp1,p$lambda)
###################
##     RUN THIS IN R FOR CLASS    ##
###################
library(leaps)
leaps <- regsubsets(sysbp1t~ bmi1 + age1 +
diabp1 + prevhyp1 + prevchd1 + prevmi1 +
cursmoke1 + cigpday1 + bpmeds1, data=fhs, nbest=1)
summary(leaps)
leaps <- regsubsets(sysbp1t~ bmi1 + age1 +
diabp1 + prevhyp1 + prevchd1 + prevmi1 +
cursmoke1 + cigpday1 + bpmeds1, data=fhs, nbest=3)
summary(leaps)
names(leaps)
names(summary(leaps))
summary(leaps)$bic
min(summary(leaps)$bic)
###################
##     RUN THIS IN R FOR CLASS    ##
###################
library(leaps)
leaps <- regsubsets(sysbp1t~ bmi1 + age1 +
diabp1 + prevhyp1 + prevchd1 + prevmi1 +
cursmoke1 + cigpday1 + bpmeds1, data=fhs, nbest=1)
summary(leaps)
names(summary(leaps))
min(summary(leaps)$bic)
min(summary(leaps)$bic)
which(summary(leaps)$bic == min(summary(leaps)$bic))
summary(leaps)
#Variables we care about in model
myvars <- c("sysbp1t", "bmi1", "age1", "diabp1", "prevhyp1", "prevchd1",
"prevmi1", "cursmoke1", "cigpday1", "bpmeds1")
#Selecting only these variables
fhs_sub_sel <- fhs[myvars]
#Selecting only those rows with complete cases
fhs_sub_sel <- fhs_sub_sel[complete.cases(fhs_sub_sel),]
fhs[myvars]
complete.cases(fhs_sub_sel)
#Variables we care about in model
myvars <- c("sysbp1t", "bmi1", "age1", "diabp1", "prevhyp1", "prevchd1",
"prevmi1", "cursmoke1", "cigpday1", "bpmeds1")
#Selecting only these variables
fhs_sub_sel <- fhs[myvars]
#Selecting only those rows with complete cases
fhs_sub_sel <- fhs_sub_sel[complete.cases(fhs_sub_sel),]
library(MASS)
#Begin with model of only intercept
int_mod <- lm(sysbp1t~ 1, data=fhs_sub_sel)
#Fit forward with AIC
step_aic <- stepAIC(int_mod, scope= ~ bmi1 + age1 + diabp1 + prevhyp1 + prevchd1 + prevmi1 +  cursmoke1 +
cigpday1 + bpmeds1,  direction="forward", k=2)
step_aic$anova
#Fit forward with BIC
step_bic <- stepAIC(int_mod, scope= ~ bmi1 + age1 + diabp1 +
prevhyp1 + prevchd1 + prevmi1 +  cursmoke1 +
cigpday1 + bpmeds1,  direction="forward", k=log(n))
#Define penalty for BIC
n = dim(fhs_sub_sel)[1]
#Fit forward with BIC
step_bic <- stepAIC(int_mod, scope= ~ bmi1 + age1 + diabp1 +
prevhyp1 + prevchd1 + prevmi1 +  cursmoke1 +
cigpday1 + bpmeds1,  direction="forward", k=log(n))
step_bic$anova
full_mod <- lm(sysbp1t~ bmi1 + age1 + diabp1 + prevhyp1 + prevchd1 +
prevmi1 + cursmoke1 + cigpday1 + bpmeds1, data=fhs_sub_sel)
#Fit backward with AIC
step_aic <- stepAIC(full_mod,   direction="backward", k=2)
step_aic$anova
#Fit bacward with BIC
step_bic <- stepAIC(full_mod,   direction="backward", k=log(n))
step_bic$anova
step_bic$anova
knitr::opts_chunk$set(error = TRUE)
knitr::opts_chunk$set(warning=FALSE)
knitr::opts_chunk$set(message=FALSE)
knitr::opts_chunk$set(results="hold")
knitr::opts_chunk$set(cache=F)
knitr::opts_chunk$set(eval=F)
rat <- read.table("C:/Users/adam_/Dropbox/Brown/PHP2511/BIO 210/Data/rat.dat", quote="\"", comment.char="")
names(rat) <- c("group", "days", "status")
sum(rat$status[which(rat$group==1,)])/sum(rat$days[which(rat$group==1,)])
sum(rat$status[which(rat$group==2,)])/sum(rat$days[which(rat$group==2,)])
#Load data
rat.pois <- glm(status~ group + offset(log(days)), data=rat ,family="poisson")
summary(rat.pois)
exp(confint(rat.pois))
rat <- read.table("rat.dat", quote="\"", comment.char="")
rat <- read.table("rat.txt", quote="\"", comment.char="")
names(rat) <- c("group", "days", "status")
sum(rat$status[which(rat$group==1,)])/sum(rat$days[which(rat$group==1,)])
sum(rat$status[which(rat$group==1,)])/sum(rat$days[which(rat$group==1)])
sum(rat$status[which(rat$group==1)])/sum(rat$days[which(rat$group==1)])
rat
rat <- read.table("rat.dat", quote="\"", comment.char="")
names(rat) <- c("group", "days", "status")
sum(rat$status[which(rat$group==1)])/sum(rat$days[which(rat$group==1)])
sum(rat$status[which(rat$group==2)])/sum(rat$days[which(rat$group==2)])
sum(rat$status[which(rat$group==1),])/sum(rat$days[which(rat$group==1)])
#Load data
rat.pois <- glm(status~ group + offset(log(days)), data=rat ,family="poisson")
summary(rat.pois)
exp(confint(rat.pois))
knitr::opts_chunk$set(cache=FALSE, dev='pdf')
mon <- as.Date("2018-09-03")
# fri <- as.Date("2016-01-08")
advdate <- function(obj, adv) {
tmon <- obj + 7*(adv-1)
tfri <- obj + 4 + 7*(adv-1)
tmon <- format(tmon, format="%m/%d")
tfri <- format(tfri, format="%m/%d")
zadv <- sprintf("%02d", adv)
tmp <- paste("Week ",zadv,sep='',", ", tmon," - ",tfri)
return(tmp)
}
